# SQL复习

## 数据库引擎的选择

### InnoDB

- 事务安全（执行大量的增删改操作）
- 支持外键
- autocommit影响速度（合并语句成一个事务可以提高性能）

独享表空间、共享表空间：存储数据，索引，元数据

### MyISAM

可以被压缩、支持全文搜索

不是事务安全、不支持外键

不完全回滚，没有原子性

执行大量查询操作时，MyISAM较好

### 选择

MyISAM：不需要事务支持、并发低、数据修改少、读为主、数据一致性要求不高

InnoDB：需要事务支持、高并发、查询通过索引完成、数据更新较为频繁

InnoDB注意：主键应小，避免给索引带来负担。避免全表扫描。尽量自己控制事务，不用autocommit，不用过度追求安全性，避免主键更新。

## 字符集

latin1, utf8, gbk, big5...

1. character_set_client：客户机字符集
2. character_set_connection：数据通信链路的字符集
3. character_set_database：数据库字符集
4. character_set_filesystem：MySQL服务器文件系统的字符集
5. character_set_results：结果集的字符集
6. character_set_server：MySQL服务实例字符集
7. character_set_system：元数据字符集

## 视图

视图是用于创建动态表的静态定义，视图中的数据是根据预定义的条件从一个或多个行集中生成的。用视图可以定义一个或多个表的行列组合。为了得到所需要的行列组合的视图，可以使用select语句来指定视图中包含的行和列。

优点：

- 保护数据安全
- 简化操作
- 使分散数据集中
- 提高数据的逻辑独立性

## 触发器

触发器定义了一系列操作，这一系列操作称为触发程序，当触发事件发生时，触发程序会自动运行

触发器主要用于检视某个表的插入insert、更新update、删除delete等操作，这些操作可以分别激活该表的insert、update和delete类型的触发器程序运行，从而实现数据的自动维护。

- 用于保护表中的数据
- 自动执行触发器，保障数据库中数据的完整性，多个表之间数据的一致性

作用：

- 安全性
- 审计
- 实现复杂的数据完整性规则
- 实现复杂的非标准数据库相关完整性规则

## 事务

### 事务的四大特性

- 原子性：每个事务都必须被认为是一个不可分割的单元，事务中的操作必须同时成功才是成功的。如果事务中的任何一个操作失败，则前面执行的操作都将回滚，以保证数据的整体性没有受到影响

- 一致性：事务的一致性保证了事务完成后数据库能够处于一致性状态。如果事务执行过程中出现错误，那么数据库中的所有变化将自动回滚到另一种一致性状态。

- 隔离性：事务的隔离性确保多个事务并发访问数据时，各个事务不能相互干扰。

- 持久性：事物的持久性意味着事务一旦被提交，其改变会永久生效，不能再被撤销

脏读：一个事务可以读到另一个事务未提交的数据，称为脏读。

幻读：幻读是指当前事务读不到其他事务已经提交的修改。

## 备份

完全备份：数据库中的数据和所有对象全部备份，复制数据库文件

表备份：对一张或多张表中的数据进行备份

增量备份：在某一次完全备份的基础上，备份之后的数据变化。可以用于定期备份和自动恢复。